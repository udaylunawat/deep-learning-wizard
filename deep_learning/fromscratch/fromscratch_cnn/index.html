



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Learn deep learning and deep reinforcement learning math and code easily and quickly. Used by thousands of students and professionals from top tech companies and research institutions.">
      
      
        <link rel="canonical" href="https://www.deeplearningwizard.com/deep_learning/fromscratch/fromscratch_cnn/">
      
      
        <meta name="author" content="Ritchie Ng">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../docs/assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>From Scratch CNN Classification - Deep Learning Wizard</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../../#cnn-from-scratch" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.deeplearningwizard.com/" title="Deep Learning Wizard" class="md-header-nav__button md-logo">
          
            <i class="md-icon">whatshot</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Deep Learning Wizard
              </span>
              <span class="md-header-nav__topic">
                From Scratch CNN Classification
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../intro/" title="Deep Learning Tutorials (CPU/GPU)" class="md-tabs__link md-tabs__link--active">
          Deep Learning Tutorials (CPU/GPU)
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../machine_learning/intro/" title="Machine Learning Tutorials (CPU/GPU)" class="md-tabs__link">
          Machine Learning Tutorials (CPU/GPU)
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../programming/intro/" title="Programming Tutorials" class="md-tabs__link">
          Programming Tutorials
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../database/intro/" title="Scalable Database Tutorials" class="md-tabs__link">
          Scalable Database Tutorials
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../news/news/" title="News" class="md-tabs__link">
          News
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.deeplearningwizard.com/" title="Deep Learning Wizard" class="md-nav__button md-logo">
      
        <i class="md-icon">whatshot</i>
      
    </a>
    Deep Learning Wizard
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../about/" title="About Us" class="md-nav__link">
      About Us
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../review/" title="Reviews" class="md-nav__link">
      Reviews
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../pipeline/" title="AI Pipeline" class="md-nav__link">
      AI Pipeline
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../consultancy/" title="Consultancy" class="md-nav__link">
      Consultancy
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Deep Learning Tutorials (CPU/GPU)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Deep Learning Tutorials (CPU/GPU)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../course_progression/" title="Course Progression" class="md-nav__link">
      Course Progression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_matrices/" title="Matrices" class="md-nav__link">
      Matrices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_gradients/" title="Gradients" class="md-nav__link">
      Gradients
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_linear_regression/" title="Linear Regression" class="md-nav__link">
      Linear Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_logistic_regression/" title="Logistic Regression" class="md-nav__link">
      Logistic Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_feedforward_neuralnetwork/" title="Feedforward Neural Networks (FNN)" class="md-nav__link">
      Feedforward Neural Networks (FNN)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_convolutional_neuralnetwork/" title="Convolutional Neural Networks (CNN)" class="md-nav__link">
      Convolutional Neural Networks (CNN)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_recurrent_neuralnetwork/" title="Recurrent Neural Networks (RNN)" class="md-nav__link">
      Recurrent Neural Networks (RNN)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_lstm_neuralnetwork/" title="Long Short Term Memory Neural Networks (LSTM)" class="md-nav__link">
      Long Short Term Memory Neural Networks (LSTM)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_autoencoder/" title="Autoencoders (AE)" class="md-nav__link">
      Autoencoders (AE)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../practical_pytorch/pytorch_fc_overcomplete_ae/" title="Fully-connected Overcomplete Autoencoder (AE)" class="md-nav__link">
      Fully-connected Overcomplete Autoencoder (AE)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boosting_models_pytorch/derivative_gradient_jacobian/" title="Derivative, Gradient and Jacobian" class="md-nav__link">
      Derivative, Gradient and Jacobian
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boosting_models_pytorch/forwardpropagation_backpropagation_gradientdescent/" title="Forward- and Backward-propagation and Gradient Descent (From Scratch FNN Regression)" class="md-nav__link">
      Forward- and Backward-propagation and Gradient Descent (From Scratch FNN Regression)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fromscratch_logistic_regression/" title="From Scratch Logistic Regression Classification" class="md-nav__link">
      From Scratch Logistic Regression Classification
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        From Scratch CNN Classification
      </label>
    
    <a href="./" title="From Scratch CNN Classification" class="md-nav__link md-nav__link--active">
      From Scratch CNN Classification
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-pull" title="Data Pull" class="md-nav__link">
    Data Pull
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#imports" title="Imports" class="md-nav__link">
    Imports
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-data" title="Load Data" class="md-nav__link">
    Load Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train-test-data-split" title="Train-Test Data Split" class="md-nav__link">
    Train-Test Data Split
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forwardpropagation" title="Forwardpropagation" class="md-nav__link">
    Forwardpropagation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convolutional-layer" title="Convolutional Layer" class="md-nav__link">
    Convolutional Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-pooling-layer" title="Max Pooling Layer" class="md-nav__link">
    Max Pooling Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#affine-and-softargmax-layer" title="Affine and Soft(arg)max Layer" class="md-nav__link">
    Affine and Soft(arg)max Layer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#note-on-contiguous-vs-non-contiguous" title="Note on Contiguous vs Non-Contiguous" class="md-nav__link">
    Note on Contiguous vs Non-Contiguous
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contiguous-10-by-5-tensor" title="Contiguous 10 by 5 tensor" class="md-nav__link">
    Contiguous 10 by 5 tensor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stride-5-by-1" title="Stride 5 by 1" class="md-nav__link">
    Stride 5 by 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-contiguous-tensor-via-transpose-operation" title="Non-contiguous Tensor via Transpose Operation" class="md-nav__link">
    Non-contiguous Tensor via Transpose Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stride-1-by-5" title="Stride 1 by 5" class="md-nav__link">
    Stride 1 by 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-to-contiguous" title="Convert to Contiguous" class="md-nav__link">
    Convert to Contiguous
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boosting_models_pytorch/lr_scheduling/" title="Learning Rate Scheduling" class="md-nav__link">
      Learning Rate Scheduling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boosting_models_pytorch/optimizers/" title="Optimization Algorithms" class="md-nav__link">
      Optimization Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boosting_models_pytorch/weight_initialization_activation_functions/" title="Weight Initialization and Activation Functions" class="md-nav__link">
      Weight Initialization and Activation Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deep_reinforcement_learning_pytorch/supervised_to_rl/" title="Supervised Learning to Reinforcement Learning (RL)" class="md-nav__link">
      Supervised Learning to Reinforcement Learning (RL)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deep_reinforcement_learning_pytorch/bellman_mdp/" title="Markov Decision Processes (MDP) and Bellman Equations" class="md-nav__link">
      Markov Decision Processes (MDP) and Bellman Equations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deep_reinforcement_learning_pytorch/dynamic_programming_frozenlake/" title="Dynamic Programming" class="md-nav__link">
      Dynamic Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../production_pytorch/speed_optimization_basics_numba/" title="Speed Optimization Basics Numba" class="md-nav__link">
      Speed Optimization Basics Numba
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../readings/" title="Additional Readings" class="md-nav__link">
      Additional Readings
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Machine Learning Tutorials (CPU/GPU)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Machine Learning Tutorials (CPU/GPU)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../machine_learning/intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../machine_learning/gpu/rapids_cudf/" title="GPU DataFrames" class="md-nav__link">
      GPU DataFrames
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../machine_learning/gpu/gpu_fractional_differencing/" title="GPU/CPU Fractional Differencing" class="md-nav__link">
      GPU/CPU Fractional Differencing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Programming Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Programming Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../programming/intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../programming/cpp/cpp/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../programming/bash/bash/" title="Bash" class="md-nav__link">
      Bash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../programming/python/python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../programming/javascript/javascript/" title="Javascript" class="md-nav__link">
      Javascript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../programming/electron/electron/" title="Electron" class="md-nav__link">
      Electron
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Scalable Database Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Scalable Database Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../database/intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../database/setting_up_cluster/" title="Cassandra Cluster Setup" class="md-nav__link">
      Cassandra Cluster Setup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      News
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        News
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/news/" title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/defence_and_science_technology_agency_dsta_nvidia_talk_2016_06/" title="Deep Learning Introduction, Defence and Science Technology Agency (DSTA) and NVIDIA, June 2019" class="md-nav__link">
      Deep Learning Introduction, Defence and Science Technology Agency (DSTA) and NVIDIA, June 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/detect_waterbone_debris_ai_for_social_good_icml_2019_06/" title="Oral Presentation for AI for Social Good Workshop ICML, June 2019" class="md-nav__link">
      Oral Presentation for AI for Social Good Workshop ICML, June 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/it_youth_leader_2019_03_11/" title="IT Youth Leader of The Year 2019, March 2019" class="md-nav__link">
      IT Youth Leader of The Year 2019, March 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/ammi_facebook_google_recap_2018_11_21/" title="AMMI (AIMS) supported by Facebook and Google, November 2018" class="md-nav__link">
      AMMI (AIMS) supported by Facebook and Google, November 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/nanjing_next_nus_tsinghua_ai_finance_healthcare_2018_11_01/" title="NExT++ AI in Healthcare and Finance, Nanjing, November 2018" class="md-nav__link">
      NExT++ AI in Healthcare and Finance, Nanjing, November 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/facebook_pytorch_devcon_recap_2018_10_02/" title="Recap of Facebook PyTorch Developer Conference, San Francisco, September 2018" class="md-nav__link">
      Recap of Facebook PyTorch Developer Conference, San Francisco, September 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/facebook_pytorch_developer_conference_2018_09_05/" title="Facebook PyTorch Developer Conference, San Francisco, September 2018" class="md-nav__link">
      Facebook PyTorch Developer Conference, San Francisco, September 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/nvidia_nus_mit_datathon_2018_07_05/" title="NUS-MIT-NUHS NVIDIA Image Recognition Workshop, Singapore, July 2018" class="md-nav__link">
      NUS-MIT-NUHS NVIDIA Image Recognition Workshop, Singapore, July 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/deep_learning_wizard_1y_2018_06_01/" title="Featured on PyTorch Website 2018" class="md-nav__link">
      Featured on PyTorch Website 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/nvidia_self_driving_cars_talk_2017_06_21/" title="NVIDIA Self Driving Cars & Healthcare Talk, Singapore, June 2017" class="md-nav__link">
      NVIDIA Self Driving Cars & Healthcare Talk, Singapore, June 2017
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../news/deep_learning_wizard_nvidia_inception_2018_05_01/" title="NVIDIA Inception Partner Status, Singapore, May 2017" class="md-nav__link">
      NVIDIA Inception Partner Status, Singapore, May 2017
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-pull" title="Data Pull" class="md-nav__link">
    Data Pull
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#imports" title="Imports" class="md-nav__link">
    Imports
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-data" title="Load Data" class="md-nav__link">
    Load Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train-test-data-split" title="Train-Test Data Split" class="md-nav__link">
    Train-Test Data Split
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forwardpropagation" title="Forwardpropagation" class="md-nav__link">
    Forwardpropagation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convolutional-layer" title="Convolutional Layer" class="md-nav__link">
    Convolutional Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-pooling-layer" title="Max Pooling Layer" class="md-nav__link">
    Max Pooling Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#affine-and-softargmax-layer" title="Affine and Soft(arg)max Layer" class="md-nav__link">
    Affine and Soft(arg)max Layer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#note-on-contiguous-vs-non-contiguous" title="Note on Contiguous vs Non-Contiguous" class="md-nav__link">
    Note on Contiguous vs Non-Contiguous
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contiguous-10-by-5-tensor" title="Contiguous 10 by 5 tensor" class="md-nav__link">
    Contiguous 10 by 5 tensor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stride-5-by-1" title="Stride 5 by 1" class="md-nav__link">
    Stride 5 by 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-contiguous-tensor-via-transpose-operation" title="Non-contiguous Tensor via Transpose Operation" class="md-nav__link">
    Non-contiguous Tensor via Transpose Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stride-1-by-5" title="Stride 1 by 5" class="md-nav__link">
    Stride 1 by 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-to-contiguous" title="Convert to Contiguous" class="md-nav__link">
    Convert to Contiguous
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="cnn-from-scratch">CNN from Scratch<a class="headerlink" href="#cnn-from-scratch" title="Permanent link">&para;</a></h1>
<p><a href="https://colab.research.google.com/github/ritchieng/deep-learning-wizard/blob/master/docs/deep_learning/fromscratch/fromscratch_cnn.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>This is an implementation of a simple CNN (one convolutional function, one non-linear function, one max pooling function, one affine function and one softargmax function) for a 10-class MNIST classification task.</p>
<h2 id="data-pull">Data Pull<a class="headerlink" href="#data-pull" title="Permanent link">&para;</a></h2>
<h3 id="imports">Imports<a class="headerlink" href="#imports" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">check_random_state</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>

<h3 id="load-data">Load Data<a class="headerlink" href="#load-data" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="c1"># Load data from https://www.openml.org/d/554</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s1">&#39;mnist_784&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="c1">### Plot Single Sample</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="c1"># Print dataset</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;X shape: {X.shape}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;y shape: {y.shape}&#39;</span><span class="p">)</span>

<span class="c1"># Print size of resized single sample</span>
<span class="n">single_sample</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Single sample shape: {single_sample.shape}&#39;</span><span class="p">)</span>

<span class="c1"># Plot single sample (M x N matrix)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">single_sample</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<div class="codehilite"><pre><span></span>X shape: (70000, 784)
y shape: (70000,)
Single sample shape: (28, 28)



&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>


<p><img alt="png" src="../fromscratch_cnn_files/fromscratch_cnn_8_2.png" /></p>
<h3 id="train-test-data-split">Train-Test Data Split<a class="headerlink" href="#train-test-data-split" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="c1"># Train-test split</span>
<span class="n">train_samples</span> <span class="o">=</span> <span class="mi">60000</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">permutation</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="n">train_samples</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Print shapes</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Training shape {X_train.shape}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Testing shape {X_test.shape}&#39;</span><span class="p">)</span>
</pre></div>

<div class="codehilite"><pre><span></span>Training shape (60000, 784)
Testing shape (10000, 784)
</pre></div>


<h2 id="forwardpropagation">Forwardpropagation<a class="headerlink" href="#forwardpropagation" title="Permanent link">&para;</a></h2>
<h3 id="convolutional-layer">Convolutional Layer<a class="headerlink" href="#convolutional-layer" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ConvolutionalLayer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_kernels</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="p">):</span>
        <span class="c1"># Number of kernels: 1D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_kernels</span> <span class="o">=</span> <span class="n">num_kernels</span>
        <span class="c1"># Shape of kernels: 2D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel_shape</span> <span class="o">=</span> <span class="n">kernel_shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Kernel weights: 3D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernels_theta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_kernels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sliding generator that yields square areas of shape</span>
<span class="sd">        (kernel_shape, kernel_shape) sliding across our input. </span>
<span class="sd">        This assumes valid padding (no padding) and step size 1.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">for</span> <span class="n">h_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">w_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span>
                <span class="n">single_slide_area</span> <span class="o">=</span> <span class="n">inp</span><span class="p">[</span><span class="n">h_idx</span><span class="p">:(</span><span class="n">h_idx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">),</span> <span class="n">w_idx</span><span class="p">:(</span><span class="n">w_idx</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)]</span>
                <span class="k">yield</span> <span class="n">single_slide_area</span><span class="p">,</span> <span class="n">h_idx</span><span class="p">,</span><span class="n">w_idx</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Slides kernel across image doing an element-wise MM then summing.</span>
<span class="sd">        Results in forward pass of convolutional layer of shape</span>
<span class="sd">        (output shape, output shape, number of kernels).</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Input: 2D of (height, width)</span>
        <span class="k">assert</span> <span class="n">single_sample</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;Input not 2D, given {single_sample.dim()}D&#39;</span>

        <span class="c1"># Output via Valid Padding (No Padding): 3D of (height, width, number of kernels)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">w</span>  <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span>
        <span class="c1"># P = 0</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># O = ((W - K + 2P) / S) + 1 = (28 - 3 + 0) + 1 = 25</span>
        <span class="n">o</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># Print shapes</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Padding shape: </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Output shape: </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
        <span class="c1"># Initialize blank tensor</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_kernels</span><span class="p">))</span>

        <span class="c1"># Iterate through region</span>
        <span class="k">for</span> <span class="n">single_slide_area</span><span class="p">,</span> <span class="n">h_idx</span><span class="p">,</span> <span class="n">w_idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h_idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">w_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Region shape: </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">single_slide_area</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Kernel shape: </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels_theta</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Single Slide: </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">h_idx</span><span class="p">,</span> <span class="n">w_idx</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

            <span class="c1"># Sum values with each element-wise matrix multiplication across each kernel</span>
            <span class="c1"># Instead of doing another loop of each kernel, you simply just do a element-wise MM</span>
            <span class="c1"># of the single slide area with all the kernels yield, then summing the patch</span>
            <span class="n">output</span><span class="p">[</span><span class="n">h_idx</span><span class="p">,</span> <span class="n">w_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">single_slide_area</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels_theta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="c1"># Pass through non-linearity (sigmoid): 1 / 1 + exp(-output)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">output</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">output</span>

<span class="c1"># Convert numpy array to torch tensor</span>
<span class="n">single_sample</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">single_sample</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">single_sample</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Input shape: </span><span class="se">\t</span><span class="s1"> {list(single_sample.shape)}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Forward: conv</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">ConvolutionalLayer</span><span class="p">(</span><span class="n">num_kernels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">kernel_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">single_sample</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Conv (f) shape: </span><span class="se">\t</span><span class="s1"> {list(output.shape)}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

<div class="codehilite"><pre><span></span>==================================================
Input shape:     [28, 28]
==================================================
Padding shape:   0
Output shape:    24
Region shape:    [5, 5]
Kernel shape:    [8, 5, 5]
Single Slide:    [8]
==================================================
Conv (f) shape:      [24, 24, 8]
==================================================
</pre></div>


<h3 id="max-pooling-layer">Max Pooling Layer<a class="headerlink" href="#max-pooling-layer" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MaxPoolLayer</span><span class="p">:</span>
    <span class="c1"># O = ((W - K) / S) + 1</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pooling_kernel_shape</span><span class="p">):</span>
        <span class="c1"># Assume simplicity of K = S then O = W / S</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">pooling_kernel_shape</span>

    <span class="k">def</span> <span class="nf">slider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sliding generator that yields areas for max pooling.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">output_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>  <span class="c1"># Assume S = K</span>

        <span class="k">for</span> <span class="n">h_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">output_size</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">w_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">output_size</span><span class="p">):</span>
                <span class="n">single_slide_area</span> <span class="o">=</span> <span class="n">inp</span><span class="p">[</span><span class="n">h_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span><span class="n">h_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                                        <span class="n">w_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span><span class="n">w_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">]</span>
                <span class="k">yield</span> <span class="n">single_slide_area</span><span class="p">,</span> <span class="n">h_idx</span><span class="p">,</span> <span class="n">w_idx</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Performs a forward pass of the maxpool layer using the given input.</span>
<span class="sd">        Returns a 3d numpy array with dimensions (h / 2, w / 2, num_filters).</span>
<span class="sd">        - input is a 3d numpy array with dimensions (h, w, num_filters)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_input</span> <span class="o">=</span> <span class="n">inp</span>

        <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">num_kernels</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">output_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>  <span class="c1"># Assume S = K</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">,</span> <span class="n">num_kernels</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">single_slide_area</span><span class="p">,</span> <span class="n">h_idx</span><span class="p">,</span> <span class="n">w_idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
            <span class="n">single_slide_area</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">single_slide_area</span><span class="p">,</span> <span class="n">start_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="n">h_idx</span><span class="p">,</span> <span class="n">w_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">single_slide_area</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

        <span class="k">return</span> <span class="n">output</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Input shape: </span><span class="se">\t</span><span class="s1"> {list(output.shape)}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Forward: pool</span>
<span class="n">pool</span> <span class="o">=</span> <span class="n">MaxPoolLayer</span><span class="p">(</span><span class="n">pooling_kernel_shape</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Pool (f) shape: </span><span class="se">\t</span><span class="s1"> {list(output.shape)}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

<div class="codehilite"><pre><span></span>==================================================
Input shape:     [24, 24, 8]
==================================================
==================================================
Pool (f) shape:      [12, 12, 8]
==================================================
</pre></div>


<h3 id="affine-and-softargmax-layer">Affine and Soft(arg)max Layer<a class="headerlink" href="#affine-and-softargmax-layer" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AffineAndSoftmaxLayer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">affine_weight_shape</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span> <span class="o">=</span> <span class="n">affine_weight_shape</span>
        <span class="c1"># Weight shape: flattened input x output shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="c1"># Initialize weight/bias via Lecun initialization of 1 / N standard deviation</span>
        <span class="c1"># Refer to DLW guide on weight initialization mathematical derivation:</span>
        <span class="c1"># https://www.deeplearningwizard.com/deep_learning/boosting_models_pytorch/weight_initialization_activation_functions/</span>
        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Lecun initialization SD: {1/self.affine_weight_shape[3]}&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">normal_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">normal_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">affine_weight_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Performs Linear (Affine) Function &amp; Soft(arg)max Function</span>
<span class="sd">        that returns our vector (1D) of probabilities.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;input shape: </span><span class="se">\t</span><span class="s1"> {inp.shape}&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;weight shape: </span><span class="se">\t</span><span class="s1"> {self.w.shape}&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;bias shape: </span><span class="se">\t</span><span class="s1"> {self.b.shape}&#39;</span><span class="p">)</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="n">probas</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logits</span><span class="p">)</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logits</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">probas</span>


<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Input shape: </span><span class="se">\t</span><span class="s1"> {list(output.shape)}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Forward: Affine and Softmax</span>
<span class="n">affinesoftmax</span> <span class="o">=</span> <span class="n">AffineAndSoftmaxLayer</span><span class="p">(</span><span class="n">affine_weight_shape</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">))))</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">affinesoftmax</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Affine &amp; Soft(arg)max (f) shape: </span><span class="se">\t</span><span class="s1"> {list(output.shape)}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Probas: {pd.DataFrame(output.numpy()).to_string(index=False, header=False)}&#39;</span><span class="p">)</span>
</pre></div>

<div class="codehilite"><pre><span></span>==================================================
Input shape:     [12, 12, 8]
==================================================
Lecun initialization SD: 0.1
input shape:     torch.Size([1, 1152])
weight shape:    torch.Size([1152, 10])
bias shape:      torch.Size([10])
==================================================
Affine &amp; Soft(arg)max (f) shape:     [1, 10]
==================================================
Probas:  0.72574  0.001391  0.000083  0.202983  0.000503  0.037023  0.000428  0.000144  0.031293  0.000412
</pre></div>


<div class="admonition note">
<p class="admonition-title">Dot Product, Matrix Multiplication, and Hadamard Product</p>
<p><strong>Hadamard product</strong>: element-wise multiplicaton of 2 matrices.
</br><strong>Matrix Multiplication</strong>: take the first row of the first matrix and perform dot product with each of the N columns in the second matrix to form N columns in the first row of the new matrix. Repeat for remaining rows for the first matrix.    </p>
</div>
<div class="codehilite"><pre><span></span><span class="c1"># Backward &amp; GD: linear + softmax</span>

<span class="c1"># Backward &amp; GD: pool</span>

<span class="c1"># Backward &amp; GD: conv</span>
</pre></div>

<h2 id="note-on-contiguous-vs-non-contiguous">Note on Contiguous vs Non-Contiguous<a class="headerlink" href="#note-on-contiguous-vs-non-contiguous" title="Permanent link">&para;</a></h2>
<ul>
<li>Often in the space of passing tensors, and doing all our dot products, hadamard products, matrix multiplications, transpose, reshape operations and more, you would inevitably one day encounter into an error that says your tensor is <code class="codehilite">not contiguous</code>. </li>
<li>This is a memory allocation problem. </li>
<li>Certain tensor operations like <code class="codehilite">transpose, view, expand, narrow etc</code> do not change the original tensor, instead they modify the properties of the tensor. <ul>
<li>For example, <code class="codehilite">transpose</code>, demonstrated here, would change the shape (index), but both the old and modified property tensor share the same memory block with different indexes/addresses.</li>
<li>This is why it's non-contiguous and we need to make it contiguous for some operations and typically for efficiency purpose.</li>
</ul>
</li>
<li>This is not a blanket statement, but you typically want your tensors to be contiguous as it prevents additional overhead incurred from translating addresses.<ul>
<li>Whenever there's a warning that prompts you the tensor is not contiguous, just call <code class="codehilite"><span class="na">.contiguous</span><span class="p">()</span></code> and you typically should be good to go.</li>
</ul>
</li>
</ul>
<h3 id="contiguous-10-by-5-tensor">Contiguous 10 by 5 tensor<a class="headerlink" href="#contiguous-10-by-5-tensor" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">contiguous_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">contiguous_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># Pretty print quick hack via Pandas DataFrame</span>
<span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">contiguous_tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></div>

<div class="codehilite"><pre><span></span>torch.Size([10, 5])
  0   1   2   3   4
  5   6   7   8   9
 10  11  12  13  14
 15  16  17  18  19
 20  21  22  23  24
 25  26  27  28  29
 30  31  32  33  34
 35  36  37  38  39
 40  41  42  43  44
 45  46  47  48  49
</pre></div>


<h3 id="stride-5-by-1">Stride 5 by 1<a class="headerlink" href="#stride-5-by-1" title="Permanent link">&para;</a></h3>
<ul>
<li>Stride here shows how we need:<ul>
<li>5 steps to move one row to the next &amp;</li>
<li>1 step to move from one column to the next (contiguous)<ul>
<li>If this becomes anything other than 1 step, it becomes not contiguous</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">contiguous_tensor</span><span class="o">.</span><span class="n">stride</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">contiguous_tensor</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
</pre></div>

<div class="codehilite"><pre><span></span>(5, 1)
True
</pre></div>


<h3 id="non-contiguous-tensor-via-transpose-operation">Non-contiguous Tensor via Transpose Operation<a class="headerlink" href="#non-contiguous-tensor-via-transpose-operation" title="Permanent link">&para;</a></h3>
<ul>
<li>In order to access the next "column" value of 5, we have to take 5 steps despite the transpose as if we would do in our original tensor</li>
<li>Because the original tensor and this transposed tensor share the same memory block!</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">non_contiguous_tensor</span> <span class="o">=</span> <span class="n">contiguous_tensor</span><span class="o">.</span><span class="n">t</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">non_contiguous_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">non_contiguous_tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></div>

<div class="codehilite"><pre><span></span>torch.Size([5, 10])
 0  5  10  15  20  25  30  35  40  45
 1  6  11  16  21  26  31  36  41  46
 2  7  12  17  22  27  32  37  42  47
 3  8  13  18  23  28  33  38  43  48
 4  9  14  19  24  29  34  39  44  49
</pre></div>


<h3 id="stride-1-by-5">Stride 1 by 5<a class="headerlink" href="#stride-1-by-5" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">non_contiguous_tensor</span><span class="o">.</span><span class="n">stride</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">non_contiguous_tensor</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
</pre></div>

<div class="codehilite"><pre><span></span>(1, 5)
False
</pre></div>


<h3 id="convert-to-contiguous">Convert to Contiguous<a class="headerlink" href="#convert-to-contiguous" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="c1"># Convert to contiguous</span>
<span class="n">convert_contiguous</span> <span class="o">=</span> <span class="n">non_contiguous_tensor</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">convert_contiguous</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
</pre></div>

<div class="codehilite"><pre><span></span>True
</pre></div>
                
                  
                
              
              
                


  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "https://www.deeplearningwizard.com/deep_learning/fromscratch/fromscratch_cnn/";
      this.page.identifier =
        "deep_learning/fromscratch/fromscratch_cnn/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//deep-learning-wizard.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="deep_learning/fromscratch/fromscratch_logistic_regression/" title="From Scratch Logistic Regression Classification" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                From Scratch Logistic Regression Classification
              </span>
            </div>
          </a>
        
        
          <a href="deep_learning/boosting_models_pytorch/lr_scheduling/" title="Learning Rate Scheduling" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Learning Rate Scheduling
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Deep Learning Wizard by Ritchie Ng
          </div>
        
        proudly an
        <a href="http://www.nvidia.com/page/home.html">NVIDIA Inception Partner</a> and supported by the
        <a href="https://aws.amazon.com/activate/">Amazon AWS Activate Programme</a> by
        <a href="https://www.ritchieng.com/">
          Ritchie Ng</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/ritchieng" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.facebook.com/DeepLearningWizard/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.linkedin.com/company/deeplearningwizard/" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-122083328-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>